# -*- restclient -*-
:host = http://localhost
:port = 8000

#:host = https://omicidx-test.cancerdatasci.org
#:port = 443

#
# Get a single experiment
# Also sends a User-Agent header, because the Github API requires this.
#
GET :host::port/experiment/SRX000237
User-Agent: Emacs Restclient


#
POST :host::port/experiments/extendedSearch
content-type: "application/json"
{
  "query": {
    "simple_query_string": {
      "query": "cancer"
    }
  }
}

#
POST :host::port/experiments/extendedSearch
content-type: "application/json"
{
  "query": {
    "bool": {
      "must": {
        "term": {"library_strategy": "RNA-Seq"},

	"term": {"center_name": "GEO"}
      }
    }
  }
}



# Perform term search. Note that term search should never be used in the
# context of a "text" field. Instead, use on a keyword field.		
#
POST :host::port/experiments/extendedSearch
content-type: "application/json"
{
  "query": {
    "term": {
      "library_strategy.keyword": "RNA-Seq"
    }
  }
}


# Search all fields for RNA-seq (full text, so not necessarily exact)
#
POST :host::port/experiments/extendedSearch
content-type: "application/json"
{
  "query": {
    "multi_match": {
      "query": "RNA-Seq",
      "fields": ["*"]
    }
  }
}

# This query will return nearly all records, including
# stuff that is not library_strategy="RNA-Seq" since
# it is a full text search.
#
POST :host::port/experiments/extendedSearch
content-type: "application/json"
{
  "query": {
    "multi_match": {
      "query": "RNA-Seq",
      "fields": ["*"]
    }
  },
  "size": 0,
  "aggs": {
    "library_strategy" : {
      "terms": {"field": "library_strategy.keyword"}
    }
  }	    
}

# This query will return only RNA-seq library_strategy.
#
POST :host::port/experiments/extendedSearch
content-type: "application/json"
{
  "query": {
    "term": {
      "library_strategy.keyword": "RNA-Seq"
    }
  },
  "size": 0,
  "aggs": {
    "library_strategy" : {
      "terms": {"field": "library_strategy.keyword"}
    }
  }	    
}

# This query will return a date histogram of
# RNA-Seq publication dates, grouped by month.
#
POST :host::port/experiments/extendedSearch
content-type: "application/json"
{
  "query": {
    "term": {
      "library_strategy.keyword": "RNA-Seq"
    }
  },
  "size": 0,
  "aggs": {
    "library_strategy" : {
      "terms": {"field": "library_strategy.keyword"}
    },
    "by_month": {
      "date_histogram" : {
         "field" : "published",
         "calendar_interval" : "month"
       }
    }
  }	    
}
